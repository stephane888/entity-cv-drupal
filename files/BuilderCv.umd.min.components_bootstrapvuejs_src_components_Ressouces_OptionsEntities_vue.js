"use strict";
((typeof self !== 'undefined' ? self : this)["webpackChunkBuilderCv"] = (typeof self !== 'undefined' ? self : this)["webpackChunkBuilderCv"] || []).push([["components_bootstrapvuejs_src_components_Ressouces_OptionsEntities_vue"],{

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue":
/*!*********************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OptionsEntities.vue?vue&type=template&id=54a0ff8d& */ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&");
/* harmony import */ var _OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OptionsEntities.vue?vue&type=script&lang=js& */ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&");
/* harmony import */ var _entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js */ "./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js");





/* normalize component */
;
var component = (0,_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__["default"])(
  _OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.render,
  _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) { var api; }
component.options.__file = "components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&":
/*!**********************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OptionsEntities.vue?vue&type=script&lang=js& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&");
 /* harmony default export */ __webpack_exports__["default"] = (_entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&":
/*!****************************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d& ***!
  \****************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.render; },
/* harmony export */   "staticRenderFns": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns; }
/* harmony export */ });
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OptionsEntities.vue?vue&type=template&id=54a0ff8d& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&");


/***/ }),

/***/ "../drupal-vuejs/src/App/jsonApi/itemsEntity.js":
/*!******************************************************!*\
  !*** ../drupal-vuejs/src/App/jsonApi/itemsEntity.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "../drupal-vuejs/node_modules/core-js/modules/es.array.push.js");
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities.js */ "../drupal-vuejs/src/App/utilities.js");
/* harmony import */ var _Confs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Confs.js */ "../drupal-vuejs/src/App/jsonApi/Confs.js");
/* harmony import */ var _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./buildFilter.js */ "../drupal-vuejs/src/App/jsonApi/buildFilter.js");




class itemsEntity {
  constructor(entity_type_id, bundle = null, config = null) {
    this.entity_type_id = entity_type_id;
    //
    if (!bundle) {
      bundle = entity_type_id;
    }
    this.url = _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].baseURl + "/" + this.entity_type_id + "/" + bundle;
    this.items = [];
    this.newConfig = config;
    // En function de l'environement on doit ajouter les paramettres de bases.( notament baseUrl, TestDomain, les methodes surchargées ).
    if (config) {
      // à ce state la surcharge total pose probleme, donc on doit surcharger par necessite.
      // utilities = {
      //   ...utilities,
      //   ...config,
      // };
      if (config.TestDomain) _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].TestDomain = config.TestDomain;
    }
  }
  /**
   * Recupere les items en passant par le token.
   * ( ce cas de figure correspond à une application qui est sur le meme domaine ).
   */
  get() {
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   * Recupere les items
   */
  getSearch(search) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("name", "CONTAINS", search);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   *
   * @returns *
   */
  getValue(term) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("name", "=", term);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   *
   * @returns *
   */
  getValueByTid(id) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("tid", "=", id);
    return new Promise((resolv, reject) => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      }).catch(er => {
        reject(er);
      });
    });
  }

  /**
   *
   * @returns *
   */
  getValueById(id) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    let fieldId = "id";
    switch (this.entity_type_id) {
      case "user":
        fieldId = "uid";
        break;
      case "domain":
        fieldId = "drupal_internal__id";
        break;
    }
    filter.addFilter(fieldId, "=", id);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].get(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   * Retourne les termes sous formes de liste d'otpions.
   */
  getOptions() {
    const options = [];
    for (const i in this.items.data) {
      const term = this.items.data[i];
      if (this.entity_type_id == "user") {
        options.push({
          text: term.attributes.name,
          value: term.attributes.drupal_internal__uid
        });
      } else if (term.attributes.name) {
        options.push({
          text: term.attributes.name,
          value: term.attributes.drupal_internal__id
        });
      } else if (term.attributes.label) {
        options.push({
          text: term.attributes.label,
          value: term.attributes.drupal_internal__id
        });
      }
    }
    return options;
  }
  /**
   * On a deux cas interne et externe au domaine, et en function de l'environnement
   * on doit utiliser token ou basic authentification.
   * ( On ajoute cette variable en attendant la validation des autres modules de plus
   * il faudra que dans "config" la methode dGet existe, ce qui n'est pas le cas pour certains environnement.
   * gestion-projet-v2 => OK (en mode serve)
   * edit-entity => ??
   * Creation-cv => ??
   * Creation de site web => ??
   * ).
   */
  remplaceConfig() {
    _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"] = this.newConfig;
  }
}
/* harmony default export */ __webpack_exports__["default"] = (itemsEntity);

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&":
/*!*************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js& ***!
  \*************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "../components_bootstrapvuejs/node_modules/core-js/modules/es.array.push.js");
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var drupal_vuejs_src_App_jsonApi_itemsEntity_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drupal-vuejs/src/App/jsonApi/itemsEntity.js */ "../drupal-vuejs/src/App/jsonApi/itemsEntity.js");
/* harmony import */ var _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fieldsDrupal/loadField.js */ "../components_bootstrapvuejs/src/components/fieldsDrupal/loadField.js");



/* harmony default export */ __webpack_exports__["default"] = ({
  name: "OptionsEntities",
  components: {},
  props: {
    field: {
      type: Object,
      required: true
    },
    model: {
      type: [Object, Array],
      required: true
    },
    namespaceStore: {
      type: String,
      required: true
    }
  },
  data() {
    return {
      options: [],
      selected: null
    };
  },
  mounted() {
    this.loadTerms();
    this.selected = this.getValue();
  },
  methods: {
    loadTerms() {
      let entity_type_id = this.getFistVocab();
      if (entity_type_id && _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__["default"].config) {
        const terms = new drupal_vuejs_src_App_jsonApi_itemsEntity_js__WEBPACK_IMPORTED_MODULE_1__["default"](entity_type_id, entity_type_id, _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__["default"].config);
        terms.get().then(() => {
          this.options = terms.getOptions();
        });
      }
    },
    /**
     * --
     */
    getFistVocab() {
      if (this.field.definition_settings.handler_settings.target_bundles) {
        const keys = Object.keys(this.field.definition_settings.handler_settings.target_bundles);
        return this.field.definition_settings.handler_settings.target_bundles[keys[0]];
      } else if (this.field.definition_settings.target_type) {
        return this.field.definition_settings.target_type;
      } else return null;
    },
    /**
     *
     * @param {*} val
     */
    input(val) {
      const vals = [];
      vals.push({
        target_id: val
      });
      this.$emit("setValue", vals);
    },
    /**
     * --
     */
    getValue() {
      if (this.model[this.field.name] && this.model[this.field.name][0]) {
        if (this.model[this.field.name][0].value) return this.model[this.field.name][0].value;else return this.model[this.field.name][0].target_id;
      } else return null;
    }
  }
});

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* binding */ render; },
/* harmony export */   "staticRenderFns": function() { return /* binding */ staticRenderFns; }
/* harmony export */ });
var render = function render() {
  var _vm = this,
    _c = _vm._self._c;
  return _c("div", [_c("b-form-group", {
    attrs: {
      label: _vm.field.label
    }
  }, [_vm.field.type == "options_select" ? _c("b-form-select", {
    attrs: {
      options: _vm.options,
      name: _vm.field.name
    },
    on: {
      change: _vm.input
    },
    model: {
      value: _vm.selected,
      callback: function ($$v) {
        _vm.selected = $$v;
      },
      expression: "selected"
    }
  }) : _c("b-form-radio-group", {
    attrs: {
      options: _vm.options,
      name: _vm.field.name
    },
    on: {
      change: _vm.input
    },
    model: {
      value: _vm.selected,
      callback: function ($$v) {
        _vm.selected = $$v;
      },
      expression: "selected"
    }
  })], 1)], 1);
};
var staticRenderFns = [];
render._withStripped = true;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQnVpbGRlckN2LnVtZC5taW4uY29tcG9uZW50c19ib290c3RyYXB2dWVqc19zcmNfY29tcG9uZW50c19SZXNzb3VjZXNfT3B0aW9uc0VudGl0aWVzX3Z1ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQThGO0FBQzNCO0FBQ0w7OztBQUc5RDtBQUNBLENBQTBIO0FBQzFILGdCQUFnQixnSUFBVTtBQUMxQixFQUFFLHFGQUFNO0FBQ1IsRUFBRSx1RkFBTTtBQUNSLEVBQUUsZ0dBQWU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSSxLQUFVLEVBQUUsWUFpQmY7QUFDRDtBQUNBLCtEQUFlOzs7Ozs7Ozs7Ozs7QUN0Q2lQLENBQUMsK0RBQWUsc1BBQUcsRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FFQTVPO0FBQ1Q7QUFDWTtBQUMzQyxNQUFNRyxXQUFXLENBQUM7RUFDaEJDLFdBQVcsQ0FBQ0MsY0FBYyxFQUFFQyxNQUFNLEdBQUcsSUFBSSxFQUFFQyxNQUFNLEdBQUcsSUFBSSxFQUFFO0lBQ3hELElBQUksQ0FBQ0YsY0FBYyxHQUFHQSxjQUFjO0lBQ3BDO0lBQ0EsSUFBSSxDQUFDQyxNQUFNLEVBQUU7TUFDWEEsTUFBTSxHQUFHRCxjQUFjO0lBQ3pCO0lBQ0EsSUFBSSxDQUFDRyxHQUFHLEdBQUdQLHlEQUFhLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FBQ0ksY0FBYyxHQUFHLEdBQUcsR0FBR0MsTUFBTTtJQUNuRSxJQUFJLENBQUNJLEtBQUssR0FBRyxFQUFFO0lBQ2YsSUFBSSxDQUFDQyxTQUFTLEdBQUdKLE1BQU07SUFDdkI7SUFDQSxJQUFJQSxNQUFNLEVBQUU7TUFDVjtNQUNBO01BQ0E7TUFDQTtNQUNBO01BQ0EsSUFBSUEsTUFBTSxDQUFDSyxVQUFVLEVBQUVaLGdFQUFvQixHQUFHTyxNQUFNLENBQUNLLFVBQVU7SUFDakU7RUFDRjtFQUNBO0FBQ0Y7QUFDQTtBQUNBO0VBQ0VDLEdBQUcs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QUNkO0VBQ0YsQ0FBQyxDQUFDLENBQ1AsRUFDRCxDQUFDLENBQ0YsQ0FDRixFQUNELENBQUMsQ0FDRjtBQUNILENBQUM7QUFDRCxJQUFJQyxlQUFlLEdBQUcsRUFBRTtBQUN4QlYsTUFBTSxDQUFDVyxhQUFhLEdBQUcsSUFBSSIsInNvdXJjZXMiOlsid2VicGFjazovL0J1aWxkZXJDdi8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlP2UwYjAiLCJ3ZWJwYWNrOi8vQnVpbGRlckN2Ly4uL2NvbXBvbmVudHNfYm9vdHN0cmFwdnVlanMvc3JjL2NvbXBvbmVudHMvUmVzc291Y2VzL09wdGlvbnNFbnRpdGllcy52dWU/OGI4YSIsIndlYnBhY2s6Ly9CdWlsZGVyQ3YvLi4vY29tcG9uZW50c19ib290c3RyYXB2dWVqcy9zcmMvY29tcG9uZW50cy9SZXNzb3VjZXMvT3B0aW9uc0VudGl0aWVzLnZ1ZT9jZDIyIiwid2VicGFjazovL0J1aWxkZXJDdi8uLi9kcnVwYWwtdnVlanMvc3JjL0FwcC9qc29uQXBpL2l0ZW1zRW50aXR5LmpzIiwid2VicGFjazovL0J1aWxkZXJDdi8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zIH0gZnJvbSBcIi4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD01NGEwZmY4ZCZcIlxuaW1wb3J0IHNjcmlwdCBmcm9tIFwiLi9PcHRpb25zRW50aXRpZXMudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5leHBvcnQgKiBmcm9tIFwiLi9PcHRpb25zRW50aXRpZXMudnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5cblxuLyogbm9ybWFsaXplIGNvbXBvbmVudCAqL1xuaW1wb3J0IG5vcm1hbGl6ZXIgZnJvbSBcIiEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9ydW50aW1lL2NvbXBvbmVudE5vcm1hbGl6ZXIuanNcIlxudmFyIGNvbXBvbmVudCA9IG5vcm1hbGl6ZXIoXG4gIHNjcmlwdCxcbiAgcmVuZGVyLFxuICBzdGF0aWNSZW5kZXJGbnMsXG4gIGZhbHNlLFxuICBudWxsLFxuICBudWxsLFxuICBudWxsXG4gIFxuKVxuXG4vKiBob3QgcmVsb2FkICovXG5pZiAobW9kdWxlLmhvdCkge1xuICB2YXIgYXBpID0gcmVxdWlyZShcIi9zaXRld2ViL0FwcFZ1ZWpzL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL3Z1ZS1ob3QtcmVsb2FkLWFwaS9kaXN0L2luZGV4LmpzXCIpXG4gIGFwaS5pbnN0YWxsKHJlcXVpcmUoJ3Z1ZScpKVxuICBpZiAoYXBpLmNvbXBhdGlibGUpIHtcbiAgICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gICAgaWYgKCFhcGkuaXNSZWNvcmRlZCgnNTRhMGZmOGQnKSkge1xuICAgICAgYXBpLmNyZWF0ZVJlY29yZCgnNTRhMGZmOGQnLCBjb21wb25lbnQub3B0aW9ucylcbiAgICB9IGVsc2Uge1xuICAgICAgYXBpLnJlbG9hZCgnNTRhMGZmOGQnLCBjb21wb25lbnQub3B0aW9ucylcbiAgICB9XG4gICAgbW9kdWxlLmhvdC5hY2NlcHQoXCIuL09wdGlvbnNFbnRpdGllcy52dWU/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NTRhMGZmOGQmXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGFwaS5yZXJlbmRlcignNTRhMGZmOGQnLCB7XG4gICAgICAgIHJlbmRlcjogcmVuZGVyLFxuICAgICAgICBzdGF0aWNSZW5kZXJGbnM6IHN0YXRpY1JlbmRlckZuc1xuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5jb21wb25lbnQub3B0aW9ucy5fX2ZpbGUgPSBcImNvbXBvbmVudHNfYm9vdHN0cmFwdnVlanMvc3JjL2NvbXBvbmVudHMvUmVzc291Y2VzL09wdGlvbnNFbnRpdGllcy52dWVcIlxuZXhwb3J0IGRlZmF1bHQgY29tcG9uZW50LmV4cG9ydHMiLCJpbXBvcnQgbW9kIGZyb20gXCItIS4uLy4uLy4uLy4uL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL2JhYmVsLWxvYWRlci9saWIvaW5kZXguanM/P2Nsb25lZFJ1bGVTZXQtMTI2LnVzZVswXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIjsgZXhwb3J0IGRlZmF1bHQgbW9kOyBleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTEyNi51c2VbMF0hLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL09wdGlvbnNFbnRpdGllcy52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCIiLCJleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTEyNi51c2VbMF0hLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvbG9hZGVycy90ZW1wbGF0ZUxvYWRlci5qcz8/cnVsZVNldFsxXS5ydWxlc1szXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD01NGEwZmY4ZCZcIiIsImltcG9ydCB1dGlsaXRpZXMgZnJvbSBcIi4uL3V0aWxpdGllcy5qc1wiO1xuaW1wb3J0IENvbmZzIGZyb20gXCIuL0NvbmZzLmpzXCI7XG5pbXBvcnQgYnVpbGRGaWx0ZXIgZnJvbSBcIi4vYnVpbGRGaWx0ZXIuanNcIjtcbmNsYXNzIGl0ZW1zRW50aXR5IHtcbiAgY29uc3RydWN0b3IoZW50aXR5X3R5cGVfaWQsIGJ1bmRsZSA9IG51bGwsIGNvbmZpZyA9IG51bGwpIHtcbiAgICB0aGlzLmVudGl0eV90eXBlX2lkID0gZW50aXR5X3R5cGVfaWQ7XG4gICAgLy9cbiAgICBpZiAoIWJ1bmRsZSkge1xuICAgICAgYnVuZGxlID0gZW50aXR5X3R5cGVfaWQ7XG4gICAgfVxuICAgIHRoaXMudXJsID0gQ29uZnMuYmFzZVVSbCArIFwiL1wiICsgdGhpcy5lbnRpdHlfdHlwZV9pZCArIFwiL1wiICsgYnVuZGxlO1xuICAgIHRoaXMuaXRlbXMgPSBbXTtcbiAgICB0aGlzLm5ld0NvbmZpZyA9IGNvbmZpZztcbiAgICAvLyBFbiBmdW5jdGlvbiBkZSBsJ2Vudmlyb25lbWVudCBvbiBkb2l0IGFqb3V0ZXIgbGVzIHBhcmFtZXR0cmVzIGRlIGJhc2VzLiggbm90YW1lbnQgYmFzZVVybCwgVGVzdERvbWFpbiwgbGVzIG1ldGhvZGVzIHN1cmNoYXJnw6llcyApLlxuICAgIGlmIChjb25maWcpIHtcbiAgICAgIC8vIMOgIGNlIHN0YXRlIGxhIHN1cmNoYXJnZSB0b3RhbCBwb3NlIHByb2JsZW1lLCBkb25jIG9uIGRvaXQgc3VyY2hhcmdlciBwYXIgbmVjZXNzaXRlLlxuICAgICAgLy8gdXRpbGl0aWVzID0ge1xuICAgICAgLy8gICAuLi51dGlsaXRpZXMsXG4gICAgICAvLyAgIC4uLmNvbmZpZyxcbiAgICAgIC8vIH07XG4gICAgICBpZiAoY29uZmlnLlRlc3REb21haW4pIHV0aWxpdGllcy5UZXN0RG9tYWluID0gY29uZmlnLlRlc3REb21haW47XG4gICAgfVxuICB9XG4gIC8qKlxuICAgKiBSZWN1cGVyZSBsZXMgaXRlbXMgZW4gcGFzc2FudCBwYXIgbGUgdG9rZW4uXG4gICAqICggY2UgY2FzIGRlIGZpZ3VyZSBjb3JyZXNwb25kIMOgIHVuZSBhcHBsaWNhdGlvbiBxdWkgZXN0IHN1ciBsZSBtZW1lIGRvbWFpbmUgKS5cbiAgICovXG4gIGdldCgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdikgPT4ge1xuICAgICAgdXRpbGl0aWVzLmRHZXQodGhpcy51cmwsIENvbmZzLmhlYWRlcnMpLnRoZW4oKHJlc3ApID0+IHtcbiAgICAgICAgdGhpcy5pdGVtcyA9IHJlc3AuZGF0YTtcbiAgICAgICAgcmVzb2x2KHJlc3AuZGF0YSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUmVjdXBlcmUgbGVzIGl0ZW1zXG4gICAqL1xuICBnZXRTZWFyY2goc2VhcmNoKSB7XG4gICAgY29uc3QgZmlsdGVyID0gbmV3IGJ1aWxkRmlsdGVyKCk7XG4gICAgZmlsdGVyLmFkZEZpbHRlcihcIm5hbWVcIiwgXCJDT05UQUlOU1wiLCBzZWFyY2gpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2KSA9PiB7XG4gICAgICB1dGlsaXRpZXNcbiAgICAgICAgLmRHZXQodGhpcy51cmwgKyBcIj9cIiArIGZpbHRlci5xdWVyeSwgQ29uZnMuaGVhZGVycylcbiAgICAgICAgLnRoZW4oKHJlc3ApID0+IHtcbiAgICAgICAgICB0aGlzLml0ZW1zID0gcmVzcC5kYXRhO1xuICAgICAgICAgIHJlc29sdihyZXNwLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICpcbiAgICogQHJldHVybnMgKlxuICAgKi9cbiAgZ2V0VmFsdWUodGVybSkge1xuICAgIGNvbnN0IGZpbHRlciA9IG5ldyBidWlsZEZpbHRlcigpO1xuICAgIGZpbHRlci5hZGRGaWx0ZXIoXCJuYW1lXCIsIFwiPVwiLCB0ZXJtKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdikgPT4ge1xuICAgICAgdXRpbGl0aWVzXG4gICAgICAgIC5kR2V0KHRoaXMudXJsICsgXCI/XCIgKyBmaWx0ZXIucXVlcnksIENvbmZzLmhlYWRlcnMpXG4gICAgICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgdGhpcy5pdGVtcyA9IHJlc3AuZGF0YTtcbiAgICAgICAgICByZXNvbHYocmVzcC5kYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqXG4gICAqIEByZXR1cm5zICpcbiAgICovXG4gIGdldFZhbHVlQnlUaWQoaWQpIHtcbiAgICBjb25zdCBmaWx0ZXIgPSBuZXcgYnVpbGRGaWx0ZXIoKTtcbiAgICBmaWx0ZXIuYWRkRmlsdGVyKFwidGlkXCIsIFwiPVwiLCBpZCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHYsIHJlamVjdCkgPT4ge1xuICAgICAgdXRpbGl0aWVzXG4gICAgICAgIC5kR2V0KHRoaXMudXJsICsgXCI/XCIgKyBmaWx0ZXIucXVlcnksIENvbmZzLmhlYWRlcnMpXG4gICAgICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgdGhpcy5pdGVtcyA9IHJlc3AuZGF0YTtcbiAgICAgICAgICByZXNvbHYocmVzcC5kYXRhKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcikgPT4ge1xuICAgICAgICAgIHJlamVjdChlcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEByZXR1cm5zICpcbiAgICovXG4gIGdldFZhbHVlQnlJZChpZCkge1xuICAgIGNvbnN0IGZpbHRlciA9IG5ldyBidWlsZEZpbHRlcigpO1xuICAgIGxldCBmaWVsZElkID0gXCJpZFwiO1xuICAgIHN3aXRjaCAodGhpcy5lbnRpdHlfdHlwZV9pZCkge1xuICAgICAgY2FzZSBcInVzZXJcIjpcbiAgICAgICAgZmllbGRJZCA9IFwidWlkXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImRvbWFpblwiOlxuICAgICAgICBmaWVsZElkID0gXCJkcnVwYWxfaW50ZXJuYWxfX2lkXCI7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGZpbHRlci5hZGRGaWx0ZXIoZmllbGRJZCwgXCI9XCIsIGlkKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdikgPT4ge1xuICAgICAgdXRpbGl0aWVzXG4gICAgICAgIC5nZXQodGhpcy51cmwgKyBcIj9cIiArIGZpbHRlci5xdWVyeSwgQ29uZnMuaGVhZGVycylcbiAgICAgICAgLnRoZW4oKHJlc3ApID0+IHtcbiAgICAgICAgICB0aGlzLml0ZW1zID0gcmVzcC5kYXRhO1xuICAgICAgICAgIHJlc29sdihyZXNwLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUmV0b3VybmUgbGVzIHRlcm1lcyBzb3VzIGZvcm1lcyBkZSBsaXN0ZSBkJ290cGlvbnMuXG4gICAqL1xuICBnZXRPcHRpb25zKCkge1xuICAgIGNvbnN0IG9wdGlvbnMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IGkgaW4gdGhpcy5pdGVtcy5kYXRhKSB7XG4gICAgICBjb25zdCB0ZXJtID0gdGhpcy5pdGVtcy5kYXRhW2ldO1xuICAgICAgaWYgKHRoaXMuZW50aXR5X3R5cGVfaWQgPT0gXCJ1c2VyXCIpIHtcbiAgICAgICAgb3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICB0ZXh0OiB0ZXJtLmF0dHJpYnV0ZXMubmFtZSxcbiAgICAgICAgICB2YWx1ZTogdGVybS5hdHRyaWJ1dGVzLmRydXBhbF9pbnRlcm5hbF9fdWlkLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodGVybS5hdHRyaWJ1dGVzLm5hbWUpIHtcbiAgICAgICAgb3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICB0ZXh0OiB0ZXJtLmF0dHJpYnV0ZXMubmFtZSxcbiAgICAgICAgICB2YWx1ZTogdGVybS5hdHRyaWJ1dGVzLmRydXBhbF9pbnRlcm5hbF9faWQsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmICh0ZXJtLmF0dHJpYnV0ZXMubGFiZWwpIHtcbiAgICAgICAgb3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICB0ZXh0OiB0ZXJtLmF0dHJpYnV0ZXMubGFiZWwsXG4gICAgICAgICAgdmFsdWU6IHRlcm0uYXR0cmlidXRlcy5kcnVwYWxfaW50ZXJuYWxfX2lkLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG4gIH1cbiAgLyoqXG4gICAqIE9uIGEgZGV1eCBjYXMgaW50ZXJuZSBldCBleHRlcm5lIGF1IGRvbWFpbmUsIGV0IGVuIGZ1bmN0aW9uIGRlIGwnZW52aXJvbm5lbWVudFxuICAgKiBvbiBkb2l0IHV0aWxpc2VyIHRva2VuIG91IGJhc2ljIGF1dGhlbnRpZmljYXRpb24uXG4gICAqICggT24gYWpvdXRlIGNldHRlIHZhcmlhYmxlIGVuIGF0dGVuZGFudCBsYSB2YWxpZGF0aW9uIGRlcyBhdXRyZXMgbW9kdWxlcyBkZSBwbHVzXG4gICAqIGlsIGZhdWRyYSBxdWUgZGFucyBcImNvbmZpZ1wiIGxhIG1ldGhvZGUgZEdldCBleGlzdGUsIGNlIHF1aSBuJ2VzdCBwYXMgbGUgY2FzIHBvdXIgY2VydGFpbnMgZW52aXJvbm5lbWVudC5cbiAgICogZ2VzdGlvbi1wcm9qZXQtdjIgPT4gT0sgKGVuIG1vZGUgc2VydmUpXG4gICAqIGVkaXQtZW50aXR5ID0+ID8/XG4gICAqIENyZWF0aW9uLWN2ID0+ID8/XG4gICAqIENyZWF0aW9uIGRlIHNpdGUgd2ViID0+ID8/XG4gICAqICkuXG4gICAqL1xuICByZW1wbGFjZUNvbmZpZygpIHtcbiAgICB1dGlsaXRpZXMgPSB0aGlzLm5ld0NvbmZpZztcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgaXRlbXNFbnRpdHk7XG4iLCI8dGVtcGxhdGU+XG4gIDxkaXY+XG4gICAgPGItZm9ybS1ncm91cCA6bGFiZWw9XCJmaWVsZC5sYWJlbFwiPlxuICAgICAgPGItZm9ybS1zZWxlY3RcbiAgICAgICAgdi1pZj1cImZpZWxkLnR5cGUgPT0gJ29wdGlvbnNfc2VsZWN0J1wiXG4gICAgICAgIHYtbW9kZWw9XCJzZWxlY3RlZFwiXG4gICAgICAgIDpvcHRpb25zPVwib3B0aW9uc1wiXG4gICAgICAgIDpuYW1lPVwiZmllbGQubmFtZVwiXG4gICAgICAgIEBjaGFuZ2U9XCJpbnB1dFwiXG4gICAgICA+PC9iLWZvcm0tc2VsZWN0PlxuICAgICAgPGItZm9ybS1yYWRpby1ncm91cFxuICAgICAgICB2LWVsc2VcbiAgICAgICAgdi1tb2RlbD1cInNlbGVjdGVkXCJcbiAgICAgICAgOm9wdGlvbnM9XCJvcHRpb25zXCJcbiAgICAgICAgOm5hbWU9XCJmaWVsZC5uYW1lXCJcbiAgICAgICAgQGNoYW5nZT1cImlucHV0XCJcbiAgICAgID48L2ItZm9ybS1yYWRpby1ncm91cD5cbiAgICA8L2ItZm9ybS1ncm91cD5cbiAgPC9kaXY+XG48L3RlbXBsYXRlPlxuXG48c2NyaXB0PlxuaW1wb3J0IGl0ZW1zRW50aXR5IGZyb20gXCJkcnVwYWwtdnVlanMvc3JjL0FwcC9qc29uQXBpL2l0ZW1zRW50aXR5LmpzXCI7XG5pbXBvcnQgbG9hZEZpZWxkIGZyb20gXCIuLi9maWVsZHNEcnVwYWwvbG9hZEZpZWxkLmpzXCI7XG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6IFwiT3B0aW9uc0VudGl0aWVzXCIsXG4gIGNvbXBvbmVudHM6IHt9LFxuICBwcm9wczoge1xuICAgIGZpZWxkOiB7IHR5cGU6IE9iamVjdCwgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBtb2RlbDogeyB0eXBlOiBbT2JqZWN0LCBBcnJheV0sIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgbmFtZXNwYWNlU3RvcmU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICB9LFxuICBkYXRhKCkge1xuICAgIHJldHVybiB7XG4gICAgICBvcHRpb25zOiBbXSxcbiAgICAgIHNlbGVjdGVkOiBudWxsLFxuICAgIH07XG4gIH0sXG4gIG1vdW50ZWQoKSB7XG4gICAgdGhpcy5sb2FkVGVybXMoKTtcbiAgICB0aGlzLnNlbGVjdGVkID0gdGhpcy5nZXRWYWx1ZSgpO1xuICB9LFxuICBtZXRob2RzOiB7XG4gICAgbG9hZFRlcm1zKCkge1xuICAgICAgbGV0IGVudGl0eV90eXBlX2lkID0gdGhpcy5nZXRGaXN0Vm9jYWIoKTtcbiAgICAgIGlmIChlbnRpdHlfdHlwZV9pZCAmJiBsb2FkRmllbGQuY29uZmlnKSB7XG4gICAgICAgIGNvbnN0IHRlcm1zID0gbmV3IGl0ZW1zRW50aXR5KFxuICAgICAgICAgIGVudGl0eV90eXBlX2lkLFxuICAgICAgICAgIGVudGl0eV90eXBlX2lkLFxuICAgICAgICAgIGxvYWRGaWVsZC5jb25maWdcbiAgICAgICAgKTtcbiAgICAgICAgdGVybXMuZ2V0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zID0gdGVybXMuZ2V0T3B0aW9ucygpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIC0tXG4gICAgICovXG4gICAgZ2V0RmlzdFZvY2FiKCkge1xuICAgICAgaWYgKHRoaXMuZmllbGQuZGVmaW5pdGlvbl9zZXR0aW5ncy5oYW5kbGVyX3NldHRpbmdzLnRhcmdldF9idW5kbGVzKSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhcbiAgICAgICAgICB0aGlzLmZpZWxkLmRlZmluaXRpb25fc2V0dGluZ3MuaGFuZGxlcl9zZXR0aW5ncy50YXJnZXRfYnVuZGxlc1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5kZWZpbml0aW9uX3NldHRpbmdzLmhhbmRsZXJfc2V0dGluZ3MudGFyZ2V0X2J1bmRsZXNbXG4gICAgICAgICAga2V5c1swXVxuICAgICAgICBdO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmZpZWxkLmRlZmluaXRpb25fc2V0dGluZ3MudGFyZ2V0X3R5cGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZGVmaW5pdGlvbl9zZXR0aW5ncy50YXJnZXRfdHlwZTtcbiAgICAgIH0gZWxzZSByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHsqfSB2YWxcbiAgICAgKi9cbiAgICBpbnB1dCh2YWwpIHtcbiAgICAgIGNvbnN0IHZhbHMgPSBbXTtcbiAgICAgIHZhbHMucHVzaCh7IHRhcmdldF9pZDogdmFsIH0pO1xuICAgICAgdGhpcy4kZW1pdChcInNldFZhbHVlXCIsIHZhbHMpO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogLS1cbiAgICAgKi9cbiAgICBnZXRWYWx1ZSgpIHtcbiAgICAgIGlmICh0aGlzLm1vZGVsW3RoaXMuZmllbGQubmFtZV0gJiYgdGhpcy5tb2RlbFt0aGlzLmZpZWxkLm5hbWVdWzBdKSB7XG4gICAgICAgIGlmICh0aGlzLm1vZGVsW3RoaXMuZmllbGQubmFtZV1bMF0udmFsdWUpXG4gICAgICAgICAgcmV0dXJuIHRoaXMubW9kZWxbdGhpcy5maWVsZC5uYW1lXVswXS52YWx1ZTtcbiAgICAgICAgZWxzZSByZXR1cm4gdGhpcy5tb2RlbFt0aGlzLmZpZWxkLm5hbWVdWzBdLnRhcmdldF9pZDtcbiAgICAgIH0gZWxzZSByZXR1cm4gbnVsbDtcbiAgICB9LFxuICB9LFxufTtcbjwvc2NyaXB0PlxuIl0sIm5hbWVzIjpbInV0aWxpdGllcyIsIkNvbmZzIiwiYnVpbGRGaWx0ZXIiLCJpdGVtc0VudGl0eSIsImNvbnN0cnVjdG9yIiwiZW50aXR5X3R5cGVfaWQiLCJidW5kbGUiLCJjb25maWciLCJ1cmwiLCJiYXNlVVJsIiwiaXRlbXMiLCJuZXdDb25maWciLCJUZXN0RG9tYWluIiwiZ2V0IiwiUHJvbWlzZSIsInJlc29sdiIsImRHZXQiLCJoZWFkZXJzIiwidGhlbiIsInJlc3AiLCJkYXRhIiwiZ2V0U2VhcmNoIiwic2VhcmNoIiwiZmlsdGVyIiwiYWRkRmlsdGVyIiwicXVlcnkiLCJnZXRWYWx1ZSIsInRlcm0iLCJnZXRWYWx1ZUJ5VGlkIiwiaWQiLCJyZWplY3QiLCJjYXRjaCIsImVyIiwiZ2V0VmFsdWVCeUlkIiwiZmllbGRJZCIsImdldE9wdGlvbnMiLCJvcHRpb25zIiwiaSIsInB1c2giLCJ0ZXh0IiwiYXR0cmlidXRlcyIsIm5hbWUiLCJ2YWx1ZSIsImRydXBhbF9pbnRlcm5hbF9fdWlkIiwiZHJ1cGFsX2ludGVybmFsX19pZCIsImxhYmVsIiwicmVtcGxhY2VDb25maWciLCJjb21wb25lbnRzIiwicHJvcHMiLCJmaWVsZCIsInR5cGUiLCJyZXF1aXJlZCIsIm1vZGVsIiwibmFtZXNwYWNlU3RvcmUiLCJzZWxlY3RlZCIsIm1vdW50ZWQiLCJtZXRob2RzIiwibG9hZFRlcm1zIiwibG9hZEZpZWxkIiwidGVybXMiLCJnZXRGaXN0Vm9jYWIiLCJrZXlzIiwiaW5wdXQiLCJ2YWxzIiwidGFyZ2V0X2lkIiwicmVuZGVyIiwiX3ZtIiwiX2MiLCJfc2VsZiIsImF0dHJzIiwib24iLCJjaGFuZ2UiLCJjYWxsYmFjayIsIiQkdiIsImV4cHJlc3Npb24iLCJzdGF0aWNSZW5kZXJGbnMiLCJfd2l0aFN0cmlwcGVkIl0sInNvdXJjZVJvb3QiOiIifQ==