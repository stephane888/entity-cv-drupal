"use strict";
((typeof self !== 'undefined' ? self : this)["webpackChunkentity_cv_drupal"] = (typeof self !== 'undefined' ? self : this)["webpackChunkentity_cv_drupal"] || []).push([["components_bootstrapvuejs_src_components_Ressouces_OptionsEntities_vue"],{

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue":
/*!*********************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OptionsEntities.vue?vue&type=template&id=54a0ff8d& */ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&");
/* harmony import */ var _OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OptionsEntities.vue?vue&type=script&lang=js& */ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&");
/* harmony import */ var _entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js */ "./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js");





/* normalize component */
;
var component = (0,_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__["default"])(
  _OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.render,
  _OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) { var api; }
component.options.__file = "components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&":
/*!**********************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OptionsEntities.vue?vue&type=script&lang=js& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&");
 /* harmony default export */ __webpack_exports__["default"] = (_entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&":
/*!****************************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d& ***!
  \****************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.render; },
/* harmony export */   "staticRenderFns": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns; }
/* harmony export */ });
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_40_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_OptionsEntities_vue_vue_type_template_id_54a0ff8d___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./OptionsEntities.vue?vue&type=template&id=54a0ff8d& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&");


/***/ }),

/***/ "../drupal-vuejs/src/App/jsonApi/itemsEntity.js":
/*!******************************************************!*\
  !*** ../drupal-vuejs/src/App/jsonApi/itemsEntity.js ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "../drupal-vuejs/node_modules/core-js/modules/es.array.push.js");
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _utilities_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utilities.js */ "../drupal-vuejs/src/App/utilities.js");
/* harmony import */ var _Confs_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Confs.js */ "../drupal-vuejs/src/App/jsonApi/Confs.js");
/* harmony import */ var _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./buildFilter.js */ "../drupal-vuejs/src/App/jsonApi/buildFilter.js");




class itemsEntity {
  constructor(entity_type_id, bundle = null, config = null) {
    this.entity_type_id = entity_type_id;
    //
    if (!bundle) {
      bundle = entity_type_id;
    }
    this.url = _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].baseURl + "/" + this.entity_type_id + "/" + bundle;
    this.items = [];
    this.newConfig = config;
    // En function de l'environement on doit ajouter les paramettres de bases.( notament baseUrl, TestDomain, les methodes surchargées ).
    if (config) {
      // à ce state la surcharge total pose probleme, donc on doit surcharger par necessite.
      // utilities = {
      //   ...utilities,
      //   ...config,
      // };
      if (config.TestDomain) _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].TestDomain = config.TestDomain;
    }
  }
  /**
   * Recupere les items en passant par le token.
   * ( ce cas de figure correspond à une application qui est sur le meme domaine ).
   */
  get() {
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   * Recupere les items
   */
  getSearch(search) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("name", "CONTAINS", search);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   *
   * @returns *
   */
  getValue(term) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("name", "=", term);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   *
   * @returns *
   */
  getValueByTid(id) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    filter.addFilter("tid", "=", id);
    return new Promise((resolv, reject) => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].dGet(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      }).catch(er => {
        reject(er);
      });
    });
  }

  /**
   *
   * @returns *
   */
  getValueById(id) {
    const filter = new _buildFilter_js__WEBPACK_IMPORTED_MODULE_3__["default"]();
    let fieldId = "id";
    switch (this.entity_type_id) {
      case "user":
        fieldId = "uid";
        break;
      case "domain":
        fieldId = "drupal_internal__id";
        break;
    }
    filter.addFilter(fieldId, "=", id);
    return new Promise(resolv => {
      _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"].get(this.url + "?" + filter.query, _Confs_js__WEBPACK_IMPORTED_MODULE_2__["default"].headers).then(resp => {
        this.items = resp.data;
        resolv(resp.data);
      });
    });
  }
  /**
   * Retourne les termes sous formes de liste d'otpions.
   */
  getOptions() {
    const options = [];
    for (const i in this.items.data) {
      const term = this.items.data[i];
      if (this.entity_type_id == "user") {
        options.push({
          text: term.attributes.name,
          value: term.attributes.drupal_internal__uid
        });
      } else if (term.attributes.name) {
        options.push({
          text: term.attributes.name,
          value: term.attributes.drupal_internal__id
        });
      } else if (term.attributes.label) {
        options.push({
          text: term.attributes.label,
          value: term.attributes.drupal_internal__id
        });
      }
    }
    return options;
  }
  /**
   * On a deux cas interne et externe au domaine, et en function de l'environnement
   * on doit utiliser token ou basic authentification.
   * ( On ajoute cette variable en attendant la validation des autres modules de plus
   * il faudra que dans "config" la methode dGet existe, ce qui n'est pas le cas pour certains environnement.
   * gestion-projet-v2 => OK (en mode serve)
   * edit-entity => ??
   * Creation-cv => ??
   * Creation de site web => ??
   * ).
   */
  remplaceConfig() {
    _utilities_js__WEBPACK_IMPORTED_MODULE_1__["default"] = this.newConfig;
  }
}
/* harmony default export */ __webpack_exports__["default"] = (itemsEntity);

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js&":
/*!************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "../components_bootstrapvuejs/node_modules/core-js/modules/es.array.push.js");
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var drupal_vuejs_src_App_jsonApi_itemsEntity_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drupal-vuejs/src/App/jsonApi/itemsEntity.js */ "../drupal-vuejs/src/App/jsonApi/itemsEntity.js");
/* harmony import */ var _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../fieldsDrupal/loadField.js */ "../components_bootstrapvuejs/src/components/fieldsDrupal/loadField.js");



/* harmony default export */ __webpack_exports__["default"] = ({
  name: "OptionsEntities",
  components: {},
  props: {
    field: {
      type: Object,
      required: true
    },
    model: {
      type: [Object, Array],
      required: true
    },
    namespaceStore: {
      type: String,
      required: true
    }
  },
  data() {
    return {
      options: [],
      selected: null
    };
  },
  mounted() {
    this.loadTerms();
    this.selected = this.getValue();
  },
  methods: {
    loadTerms() {
      let entity_type_id = this.getFistVocab();
      if (entity_type_id && _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__["default"].config) {
        const terms = new drupal_vuejs_src_App_jsonApi_itemsEntity_js__WEBPACK_IMPORTED_MODULE_1__["default"](entity_type_id, entity_type_id, _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_2__["default"].config);
        terms.get().then(() => {
          this.options = terms.getOptions();
        });
      }
    },
    /**
     * --
     */
    getFistVocab() {
      if (this.field.definition_settings.handler_settings.target_bundles) {
        const keys = Object.keys(this.field.definition_settings.handler_settings.target_bundles);
        return this.field.definition_settings.handler_settings.target_bundles[keys[0]];
      } else if (this.field.definition_settings.target_type) {
        return this.field.definition_settings.target_type;
      } else return null;
    },
    /**
     *
     * @param {*} val
     */
    input(val) {
      const vals = [];
      vals.push({
        target_id: val
      });
      this.$emit("setValue", vals);
    },
    /**
     * --
     */
    getValue() {
      if (this.model[this.field.name] && this.model[this.field.name][0]) {
        if (this.model[this.field.name][0].value) return this.model[this.field.name][0].value;else return this.model[this.field.name][0].target_id;
      } else return null;
    }
  }
});

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d&":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/OptionsEntities.vue?vue&type=template&id=54a0ff8d& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* binding */ render; },
/* harmony export */   "staticRenderFns": function() { return /* binding */ staticRenderFns; }
/* harmony export */ });
var render = function render() {
  var _vm = this,
    _c = _vm._self._c;
  return _c("div", [_c("b-form-group", {
    attrs: {
      label: _vm.field.label
    }
  }, [_vm.field.type == "options_select" ? _c("b-form-select", {
    attrs: {
      options: _vm.options,
      name: _vm.field.name
    },
    on: {
      change: _vm.input
    },
    model: {
      value: _vm.selected,
      callback: function ($$v) {
        _vm.selected = $$v;
      },
      expression: "selected"
    }
  }) : _c("b-form-radio-group", {
    attrs: {
      options: _vm.options,
      name: _vm.field.name
    },
    on: {
      change: _vm.input
    },
    model: {
      value: _vm.selected,
      callback: function ($$v) {
        _vm.selected = $$v;
      },
      expression: "selected"
    }
  })], 1)], 1);
};
var staticRenderFns = [];
render._withStripped = true;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQnVpbGRlckN2LmNvbW1vbi5jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzX3NyY19jb21wb25lbnRzX1Jlc3NvdWNlc19PcHRpb25zRW50aXRpZXNfdnVlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBOEY7QUFDM0I7QUFDTDs7O0FBRzlEO0FBQ0EsQ0FBMEg7QUFDMUgsZ0JBQWdCLGdJQUFVO0FBQzFCLEVBQUUscUZBQU07QUFDUixFQUFFLHVGQUFNO0FBQ1IsRUFBRSxnR0FBZTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxJQUFJLEtBQVUsRUFBRSxZQWlCZjtBQUNEO0FBQ0EsK0RBQWU7Ozs7Ozs7Ozs7OztBQ3RDZ1AsQ0FBQywrREFBZSxxUEFBRyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUVBM087QUFDVDtBQUNZO0FBQzNDLE1BQU1HLFdBQVcsQ0FBQztFQUNoQkMsV0FBVyxDQUFDQyxjQUFjLEVBQUVDLE1BQU0sR0FBRyxJQUFJLEVBQUVDLE1BQU0sR0FBRyxJQUFJLEVBQUU7SUFDeEQsSUFBSSxDQUFDRixjQUFjLEdBQUdBLGNBQWM7SUFDcEM7SUFDQSxJQUFJLENBQUNDLE1BQU0sRUFBRTtNQUNYQSxNQUFNLEdBQUdELGNBQWM7SUFDekI7SUFDQSxJQUFJLENBQUNHLEdBQUcsR0FBR1AseURBQWEsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDSSxjQUFjLEdBQUcsR0FBRyxHQUFHQyxNQUFNO0lBQ25FLElBQUksQ0FBQ0ksS0FBSyxHQUFHLEVBQUU7SUFDZixJQUFJLENBQUNDLFNBQVMsR0FBR0osTUFBTTtJQUN2QjtJQUNBLElBQUlBLE1BQU0sRUFBRTtNQUNWO01BQ0E7TUFDQTtNQUNBO01BQ0E7TUFDQSxJQUFJQSxNQUFNLENBQUNLLFVBQVUsRUFBRVosZ0VBQW9CLEdBQUdPLE1BQU0sQ0FBQ0ssVUFBVTtJQUNqRTtFQUNGO0VBQ0E7QUFDRjtBQUNBO0FBQ0E7RUFDRUMsR0FBRyxH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Q2Q7RUFDRixDQUFDLENBQUMsQ0FDUCxFQUNELENBQUMsQ0FDRixDQUNGLEVBQ0QsQ0FBQyxDQUNGO0FBQ0gsQ0FBQztBQUNELElBQUlDLGVBQWUsR0FBRyxFQUFFO0FBQ3hCVixNQUFNLENBQUNXLGFBQWEsR0FBRyxJQUFJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZW50aXR5LWN2LWRydXBhbC8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlP2UwYjAiLCJ3ZWJwYWNrOi8vZW50aXR5LWN2LWRydXBhbC8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlPzkwNmMiLCJ3ZWJwYWNrOi8vZW50aXR5LWN2LWRydXBhbC8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlP2VkYzEiLCJ3ZWJwYWNrOi8vZW50aXR5LWN2LWRydXBhbC8uLi9kcnVwYWwtdnVlanMvc3JjL0FwcC9qc29uQXBpL2l0ZW1zRW50aXR5LmpzIiwid2VicGFjazovL2VudGl0eS1jdi1kcnVwYWwvLi4vY29tcG9uZW50c19ib290c3RyYXB2dWVqcy9zcmMvY29tcG9uZW50cy9SZXNzb3VjZXMvT3B0aW9uc0VudGl0aWVzLnZ1ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZW5kZXIsIHN0YXRpY1JlbmRlckZucyB9IGZyb20gXCIuL09wdGlvbnNFbnRpdGllcy52dWU/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NTRhMGZmOGQmXCJcbmltcG9ydCBzY3JpcHQgZnJvbSBcIi4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIlxuZXhwb3J0ICogZnJvbSBcIi4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIlxuXG5cbi8qIG5vcm1hbGl6ZSBjb21wb25lbnQgKi9cbmltcG9ydCBub3JtYWxpemVyIGZyb20gXCIhLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvcnVudGltZS9jb21wb25lbnROb3JtYWxpemVyLmpzXCJcbnZhciBjb21wb25lbnQgPSBub3JtYWxpemVyKFxuICBzY3JpcHQsXG4gIHJlbmRlcixcbiAgc3RhdGljUmVuZGVyRm5zLFxuICBmYWxzZSxcbiAgbnVsbCxcbiAgbnVsbCxcbiAgbnVsbFxuICBcbilcblxuLyogaG90IHJlbG9hZCAqL1xuaWYgKG1vZHVsZS5ob3QpIHtcbiAgdmFyIGFwaSA9IHJlcXVpcmUoXCIvc2l0ZXdlYi9BcHBWdWVqcy9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy92dWUtaG90LXJlbG9hZC1hcGkvZGlzdC9pbmRleC5qc1wiKVxuICBhcGkuaW5zdGFsbChyZXF1aXJlKCd2dWUnKSlcbiAgaWYgKGFwaS5jb21wYXRpYmxlKSB7XG4gICAgbW9kdWxlLmhvdC5hY2NlcHQoKVxuICAgIGlmICghYXBpLmlzUmVjb3JkZWQoJzU0YTBmZjhkJykpIHtcbiAgICAgIGFwaS5jcmVhdGVSZWNvcmQoJzU0YTBmZjhkJywgY29tcG9uZW50Lm9wdGlvbnMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGFwaS5yZWxvYWQoJzU0YTBmZjhkJywgY29tcG9uZW50Lm9wdGlvbnMpXG4gICAgfVxuICAgIG1vZHVsZS5ob3QuYWNjZXB0KFwiLi9PcHRpb25zRW50aXRpZXMudnVlP3Z1ZSZ0eXBlPXRlbXBsYXRlJmlkPTU0YTBmZjhkJlwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhcGkucmVyZW5kZXIoJzU0YTBmZjhkJywge1xuICAgICAgICByZW5kZXI6IHJlbmRlcixcbiAgICAgICAgc3RhdGljUmVuZGVyRm5zOiBzdGF0aWNSZW5kZXJGbnNcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuY29tcG9uZW50Lm9wdGlvbnMuX19maWxlID0gXCJjb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9PcHRpb25zRW50aXRpZXMudnVlXCJcbmV4cG9ydCBkZWZhdWx0IGNvbXBvbmVudC5leHBvcnRzIiwiaW1wb3J0IG1vZCBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTQwLnVzZVswXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIjsgZXhwb3J0IGRlZmF1bHQgbW9kOyBleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTQwLnVzZVswXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vT3B0aW9uc0VudGl0aWVzLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIiIsImV4cG9ydCAqIGZyb20gXCItIS4uLy4uLy4uLy4uL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL2JhYmVsLWxvYWRlci9saWIvaW5kZXguanM/P2Nsb25lZFJ1bGVTZXQtNDAudXNlWzBdIS4uLy4uLy4uLy4uL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL0B2dWUvdnVlLWxvYWRlci12MTUvbGliL2xvYWRlcnMvdGVtcGxhdGVMb2FkZXIuanM/P3J1bGVTZXRbMV0ucnVsZXNbM10hLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL09wdGlvbnNFbnRpdGllcy52dWU/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NTRhMGZmOGQmXCIiLCJpbXBvcnQgdXRpbGl0aWVzIGZyb20gXCIuLi91dGlsaXRpZXMuanNcIjtcbmltcG9ydCBDb25mcyBmcm9tIFwiLi9Db25mcy5qc1wiO1xuaW1wb3J0IGJ1aWxkRmlsdGVyIGZyb20gXCIuL2J1aWxkRmlsdGVyLmpzXCI7XG5jbGFzcyBpdGVtc0VudGl0eSB7XG4gIGNvbnN0cnVjdG9yKGVudGl0eV90eXBlX2lkLCBidW5kbGUgPSBudWxsLCBjb25maWcgPSBudWxsKSB7XG4gICAgdGhpcy5lbnRpdHlfdHlwZV9pZCA9IGVudGl0eV90eXBlX2lkO1xuICAgIC8vXG4gICAgaWYgKCFidW5kbGUpIHtcbiAgICAgIGJ1bmRsZSA9IGVudGl0eV90eXBlX2lkO1xuICAgIH1cbiAgICB0aGlzLnVybCA9IENvbmZzLmJhc2VVUmwgKyBcIi9cIiArIHRoaXMuZW50aXR5X3R5cGVfaWQgKyBcIi9cIiArIGJ1bmRsZTtcbiAgICB0aGlzLml0ZW1zID0gW107XG4gICAgdGhpcy5uZXdDb25maWcgPSBjb25maWc7XG4gICAgLy8gRW4gZnVuY3Rpb24gZGUgbCdlbnZpcm9uZW1lbnQgb24gZG9pdCBham91dGVyIGxlcyBwYXJhbWV0dHJlcyBkZSBiYXNlcy4oIG5vdGFtZW50IGJhc2VVcmwsIFRlc3REb21haW4sIGxlcyBtZXRob2RlcyBzdXJjaGFyZ8OpZXMgKS5cbiAgICBpZiAoY29uZmlnKSB7XG4gICAgICAvLyDDoCBjZSBzdGF0ZSBsYSBzdXJjaGFyZ2UgdG90YWwgcG9zZSBwcm9ibGVtZSwgZG9uYyBvbiBkb2l0IHN1cmNoYXJnZXIgcGFyIG5lY2Vzc2l0ZS5cbiAgICAgIC8vIHV0aWxpdGllcyA9IHtcbiAgICAgIC8vICAgLi4udXRpbGl0aWVzLFxuICAgICAgLy8gICAuLi5jb25maWcsXG4gICAgICAvLyB9O1xuICAgICAgaWYgKGNvbmZpZy5UZXN0RG9tYWluKSB1dGlsaXRpZXMuVGVzdERvbWFpbiA9IGNvbmZpZy5UZXN0RG9tYWluO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogUmVjdXBlcmUgbGVzIGl0ZW1zIGVuIHBhc3NhbnQgcGFyIGxlIHRva2VuLlxuICAgKiAoIGNlIGNhcyBkZSBmaWd1cmUgY29ycmVzcG9uZCDDoCB1bmUgYXBwbGljYXRpb24gcXVpIGVzdCBzdXIgbGUgbWVtZSBkb21haW5lICkuXG4gICAqL1xuICBnZXQoKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHYpID0+IHtcbiAgICAgIHV0aWxpdGllcy5kR2V0KHRoaXMudXJsLCBDb25mcy5oZWFkZXJzKS50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgIHRoaXMuaXRlbXMgPSByZXNwLmRhdGE7XG4gICAgICAgIHJlc29sdihyZXNwLmRhdGEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFJlY3VwZXJlIGxlcyBpdGVtc1xuICAgKi9cbiAgZ2V0U2VhcmNoKHNlYXJjaCkge1xuICAgIGNvbnN0IGZpbHRlciA9IG5ldyBidWlsZEZpbHRlcigpO1xuICAgIGZpbHRlci5hZGRGaWx0ZXIoXCJuYW1lXCIsIFwiQ09OVEFJTlNcIiwgc2VhcmNoKTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdikgPT4ge1xuICAgICAgdXRpbGl0aWVzXG4gICAgICAgIC5kR2V0KHRoaXMudXJsICsgXCI/XCIgKyBmaWx0ZXIucXVlcnksIENvbmZzLmhlYWRlcnMpXG4gICAgICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgdGhpcy5pdGVtcyA9IHJlc3AuZGF0YTtcbiAgICAgICAgICByZXNvbHYocmVzcC5kYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqXG4gICAqIEByZXR1cm5zICpcbiAgICovXG4gIGdldFZhbHVlKHRlcm0pIHtcbiAgICBjb25zdCBmaWx0ZXIgPSBuZXcgYnVpbGRGaWx0ZXIoKTtcbiAgICBmaWx0ZXIuYWRkRmlsdGVyKFwibmFtZVwiLCBcIj1cIiwgdGVybSk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHYpID0+IHtcbiAgICAgIHV0aWxpdGllc1xuICAgICAgICAuZEdldCh0aGlzLnVybCArIFwiP1wiICsgZmlsdGVyLnF1ZXJ5LCBDb25mcy5oZWFkZXJzKVxuICAgICAgICAudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgIHRoaXMuaXRlbXMgPSByZXNwLmRhdGE7XG4gICAgICAgICAgcmVzb2x2KHJlc3AuZGF0YSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKlxuICAgKiBAcmV0dXJucyAqXG4gICAqL1xuICBnZXRWYWx1ZUJ5VGlkKGlkKSB7XG4gICAgY29uc3QgZmlsdGVyID0gbmV3IGJ1aWxkRmlsdGVyKCk7XG4gICAgZmlsdGVyLmFkZEZpbHRlcihcInRpZFwiLCBcIj1cIiwgaWQpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2LCByZWplY3QpID0+IHtcbiAgICAgIHV0aWxpdGllc1xuICAgICAgICAuZEdldCh0aGlzLnVybCArIFwiP1wiICsgZmlsdGVyLnF1ZXJ5LCBDb25mcy5oZWFkZXJzKVxuICAgICAgICAudGhlbigocmVzcCkgPT4ge1xuICAgICAgICAgIHRoaXMuaXRlbXMgPSByZXNwLmRhdGE7XG4gICAgICAgICAgcmVzb2x2KHJlc3AuZGF0YSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXIpID0+IHtcbiAgICAgICAgICByZWplY3QoZXIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcmV0dXJucyAqXG4gICAqL1xuICBnZXRWYWx1ZUJ5SWQoaWQpIHtcbiAgICBjb25zdCBmaWx0ZXIgPSBuZXcgYnVpbGRGaWx0ZXIoKTtcbiAgICBsZXQgZmllbGRJZCA9IFwiaWRcIjtcbiAgICBzd2l0Y2ggKHRoaXMuZW50aXR5X3R5cGVfaWQpIHtcbiAgICAgIGNhc2UgXCJ1c2VyXCI6XG4gICAgICAgIGZpZWxkSWQgPSBcInVpZFwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJkb21haW5cIjpcbiAgICAgICAgZmllbGRJZCA9IFwiZHJ1cGFsX2ludGVybmFsX19pZFwiO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBmaWx0ZXIuYWRkRmlsdGVyKGZpZWxkSWQsIFwiPVwiLCBpZCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHYpID0+IHtcbiAgICAgIHV0aWxpdGllc1xuICAgICAgICAuZ2V0KHRoaXMudXJsICsgXCI/XCIgKyBmaWx0ZXIucXVlcnksIENvbmZzLmhlYWRlcnMpXG4gICAgICAgIC50aGVuKChyZXNwKSA9PiB7XG4gICAgICAgICAgdGhpcy5pdGVtcyA9IHJlc3AuZGF0YTtcbiAgICAgICAgICByZXNvbHYocmVzcC5kYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFJldG91cm5lIGxlcyB0ZXJtZXMgc291cyBmb3JtZXMgZGUgbGlzdGUgZCdvdHBpb25zLlxuICAgKi9cbiAgZ2V0T3B0aW9ucygpIHtcbiAgICBjb25zdCBvcHRpb25zID0gW107XG4gICAgZm9yIChjb25zdCBpIGluIHRoaXMuaXRlbXMuZGF0YSkge1xuICAgICAgY29uc3QgdGVybSA9IHRoaXMuaXRlbXMuZGF0YVtpXTtcbiAgICAgIGlmICh0aGlzLmVudGl0eV90eXBlX2lkID09IFwidXNlclwiKSB7XG4gICAgICAgIG9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgdGV4dDogdGVybS5hdHRyaWJ1dGVzLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHRlcm0uYXR0cmlidXRlcy5kcnVwYWxfaW50ZXJuYWxfX3VpZCxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKHRlcm0uYXR0cmlidXRlcy5uYW1lKSB7XG4gICAgICAgIG9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgdGV4dDogdGVybS5hdHRyaWJ1dGVzLm5hbWUsXG4gICAgICAgICAgdmFsdWU6IHRlcm0uYXR0cmlidXRlcy5kcnVwYWxfaW50ZXJuYWxfX2lkLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAodGVybS5hdHRyaWJ1dGVzLmxhYmVsKSB7XG4gICAgICAgIG9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgdGV4dDogdGVybS5hdHRyaWJ1dGVzLmxhYmVsLFxuICAgICAgICAgIHZhbHVlOiB0ZXJtLmF0dHJpYnV0ZXMuZHJ1cGFsX2ludGVybmFsX19pZCxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xuICB9XG4gIC8qKlxuICAgKiBPbiBhIGRldXggY2FzIGludGVybmUgZXQgZXh0ZXJuZSBhdSBkb21haW5lLCBldCBlbiBmdW5jdGlvbiBkZSBsJ2Vudmlyb25uZW1lbnRcbiAgICogb24gZG9pdCB1dGlsaXNlciB0b2tlbiBvdSBiYXNpYyBhdXRoZW50aWZpY2F0aW9uLlxuICAgKiAoIE9uIGFqb3V0ZSBjZXR0ZSB2YXJpYWJsZSBlbiBhdHRlbmRhbnQgbGEgdmFsaWRhdGlvbiBkZXMgYXV0cmVzIG1vZHVsZXMgZGUgcGx1c1xuICAgKiBpbCBmYXVkcmEgcXVlIGRhbnMgXCJjb25maWdcIiBsYSBtZXRob2RlIGRHZXQgZXhpc3RlLCBjZSBxdWkgbidlc3QgcGFzIGxlIGNhcyBwb3VyIGNlcnRhaW5zIGVudmlyb25uZW1lbnQuXG4gICAqIGdlc3Rpb24tcHJvamV0LXYyID0+IE9LIChlbiBtb2RlIHNlcnZlKVxuICAgKiBlZGl0LWVudGl0eSA9PiA/P1xuICAgKiBDcmVhdGlvbi1jdiA9PiA/P1xuICAgKiBDcmVhdGlvbiBkZSBzaXRlIHdlYiA9PiA/P1xuICAgKiApLlxuICAgKi9cbiAgcmVtcGxhY2VDb25maWcoKSB7XG4gICAgdXRpbGl0aWVzID0gdGhpcy5uZXdDb25maWc7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IGl0ZW1zRW50aXR5O1xuIiwiPHRlbXBsYXRlPlxuICA8ZGl2PlxuICAgIDxiLWZvcm0tZ3JvdXAgOmxhYmVsPVwiZmllbGQubGFiZWxcIj5cbiAgICAgIDxiLWZvcm0tc2VsZWN0XG4gICAgICAgIHYtaWY9XCJmaWVsZC50eXBlID09ICdvcHRpb25zX3NlbGVjdCdcIlxuICAgICAgICB2LW1vZGVsPVwic2VsZWN0ZWRcIlxuICAgICAgICA6b3B0aW9ucz1cIm9wdGlvbnNcIlxuICAgICAgICA6bmFtZT1cImZpZWxkLm5hbWVcIlxuICAgICAgICBAY2hhbmdlPVwiaW5wdXRcIlxuICAgICAgPjwvYi1mb3JtLXNlbGVjdD5cbiAgICAgIDxiLWZvcm0tcmFkaW8tZ3JvdXBcbiAgICAgICAgdi1lbHNlXG4gICAgICAgIHYtbW9kZWw9XCJzZWxlY3RlZFwiXG4gICAgICAgIDpvcHRpb25zPVwib3B0aW9uc1wiXG4gICAgICAgIDpuYW1lPVwiZmllbGQubmFtZVwiXG4gICAgICAgIEBjaGFuZ2U9XCJpbnB1dFwiXG4gICAgICA+PC9iLWZvcm0tcmFkaW8tZ3JvdXA+XG4gICAgPC9iLWZvcm0tZ3JvdXA+XG4gIDwvZGl2PlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCBpdGVtc0VudGl0eSBmcm9tIFwiZHJ1cGFsLXZ1ZWpzL3NyYy9BcHAvanNvbkFwaS9pdGVtc0VudGl0eS5qc1wiO1xuaW1wb3J0IGxvYWRGaWVsZCBmcm9tIFwiLi4vZmllbGRzRHJ1cGFsL2xvYWRGaWVsZC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiBcIk9wdGlvbnNFbnRpdGllc1wiLFxuICBjb21wb25lbnRzOiB7fSxcbiAgcHJvcHM6IHtcbiAgICBmaWVsZDogeyB0eXBlOiBPYmplY3QsIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgbW9kZWw6IHsgdHlwZTogW09iamVjdCwgQXJyYXldLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIG5hbWVzcGFjZVN0b3JlOiB7IHR5cGU6IFN0cmluZywgcmVxdWlyZWQ6IHRydWUgfSxcbiAgfSxcbiAgZGF0YSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgb3B0aW9uczogW10sXG4gICAgICBzZWxlY3RlZDogbnVsbCxcbiAgICB9O1xuICB9LFxuICBtb3VudGVkKCkge1xuICAgIHRoaXMubG9hZFRlcm1zKCk7XG4gICAgdGhpcy5zZWxlY3RlZCA9IHRoaXMuZ2V0VmFsdWUoKTtcbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIGxvYWRUZXJtcygpIHtcbiAgICAgIGxldCBlbnRpdHlfdHlwZV9pZCA9IHRoaXMuZ2V0RmlzdFZvY2FiKCk7XG4gICAgICBpZiAoZW50aXR5X3R5cGVfaWQgJiYgbG9hZEZpZWxkLmNvbmZpZykge1xuICAgICAgICBjb25zdCB0ZXJtcyA9IG5ldyBpdGVtc0VudGl0eShcbiAgICAgICAgICBlbnRpdHlfdHlwZV9pZCxcbiAgICAgICAgICBlbnRpdHlfdHlwZV9pZCxcbiAgICAgICAgICBsb2FkRmllbGQuY29uZmlnXG4gICAgICAgICk7XG4gICAgICAgIHRlcm1zLmdldCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHRlcm1zLmdldE9wdGlvbnMoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICAvKipcbiAgICAgKiAtLVxuICAgICAqL1xuICAgIGdldEZpc3RWb2NhYigpIHtcbiAgICAgIGlmICh0aGlzLmZpZWxkLmRlZmluaXRpb25fc2V0dGluZ3MuaGFuZGxlcl9zZXR0aW5ncy50YXJnZXRfYnVuZGxlcykge1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXMoXG4gICAgICAgICAgdGhpcy5maWVsZC5kZWZpbml0aW9uX3NldHRpbmdzLmhhbmRsZXJfc2V0dGluZ3MudGFyZ2V0X2J1bmRsZXNcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZGVmaW5pdGlvbl9zZXR0aW5ncy5oYW5kbGVyX3NldHRpbmdzLnRhcmdldF9idW5kbGVzW1xuICAgICAgICAgIGtleXNbMF1cbiAgICAgICAgXTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5maWVsZC5kZWZpbml0aW9uX3NldHRpbmdzLnRhcmdldF90eXBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmRlZmluaXRpb25fc2V0dGluZ3MudGFyZ2V0X3R5cGU7XG4gICAgICB9IGVsc2UgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsXG4gICAgICovXG4gICAgaW5wdXQodmFsKSB7XG4gICAgICBjb25zdCB2YWxzID0gW107XG4gICAgICB2YWxzLnB1c2goeyB0YXJnZXRfaWQ6IHZhbCB9KTtcbiAgICAgIHRoaXMuJGVtaXQoXCJzZXRWYWx1ZVwiLCB2YWxzKTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIC0tXG4gICAgICovXG4gICAgZ2V0VmFsdWUoKSB7XG4gICAgICBpZiAodGhpcy5tb2RlbFt0aGlzLmZpZWxkLm5hbWVdICYmIHRoaXMubW9kZWxbdGhpcy5maWVsZC5uYW1lXVswXSkge1xuICAgICAgICBpZiAodGhpcy5tb2RlbFt0aGlzLmZpZWxkLm5hbWVdWzBdLnZhbHVlKVxuICAgICAgICAgIHJldHVybiB0aGlzLm1vZGVsW3RoaXMuZmllbGQubmFtZV1bMF0udmFsdWU7XG4gICAgICAgIGVsc2UgcmV0dXJuIHRoaXMubW9kZWxbdGhpcy5maWVsZC5uYW1lXVswXS50YXJnZXRfaWQ7XG4gICAgICB9IGVsc2UgcmV0dXJuIG51bGw7XG4gICAgfSxcbiAgfSxcbn07XG48L3NjcmlwdD5cbiJdLCJuYW1lcyI6WyJ1dGlsaXRpZXMiLCJDb25mcyIsImJ1aWxkRmlsdGVyIiwiaXRlbXNFbnRpdHkiLCJjb25zdHJ1Y3RvciIsImVudGl0eV90eXBlX2lkIiwiYnVuZGxlIiwiY29uZmlnIiwidXJsIiwiYmFzZVVSbCIsIml0ZW1zIiwibmV3Q29uZmlnIiwiVGVzdERvbWFpbiIsImdldCIsIlByb21pc2UiLCJyZXNvbHYiLCJkR2V0IiwiaGVhZGVycyIsInRoZW4iLCJyZXNwIiwiZGF0YSIsImdldFNlYXJjaCIsInNlYXJjaCIsImZpbHRlciIsImFkZEZpbHRlciIsInF1ZXJ5IiwiZ2V0VmFsdWUiLCJ0ZXJtIiwiZ2V0VmFsdWVCeVRpZCIsImlkIiwicmVqZWN0IiwiY2F0Y2giLCJlciIsImdldFZhbHVlQnlJZCIsImZpZWxkSWQiLCJnZXRPcHRpb25zIiwib3B0aW9ucyIsImkiLCJwdXNoIiwidGV4dCIsImF0dHJpYnV0ZXMiLCJuYW1lIiwidmFsdWUiLCJkcnVwYWxfaW50ZXJuYWxfX3VpZCIsImRydXBhbF9pbnRlcm5hbF9faWQiLCJsYWJlbCIsInJlbXBsYWNlQ29uZmlnIiwiY29tcG9uZW50cyIsInByb3BzIiwiZmllbGQiLCJ0eXBlIiwicmVxdWlyZWQiLCJtb2RlbCIsIm5hbWVzcGFjZVN0b3JlIiwic2VsZWN0ZWQiLCJtb3VudGVkIiwibWV0aG9kcyIsImxvYWRUZXJtcyIsImxvYWRGaWVsZCIsInRlcm1zIiwiZ2V0RmlzdFZvY2FiIiwia2V5cyIsImlucHV0IiwidmFscyIsInRhcmdldF9pZCIsInJlbmRlciIsIl92bSIsIl9jIiwiX3NlbGYiLCJhdHRycyIsIm9uIiwiY2hhbmdlIiwiY2FsbGJhY2siLCIkJHYiLCJleHByZXNzaW9uIiwic3RhdGljUmVuZGVyRm5zIiwiX3dpdGhTdHJpcHBlZCJdLCJzb3VyY2VSb290IjoiIn0=